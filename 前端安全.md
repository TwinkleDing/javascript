# 前端安全

## XSS 跨站脚本攻击

1. 原理：页面渲染的数据中可能包含脚本
2. 攻击的类型：反射型：url 参数直接注入；存储型：存储到 DB 后读取时注入
3. 注入点：HTML 节点的内容；HTML 中 DOM 节点的属性；javascript 代码：输入框

### 如何防御

1. 浏览器自带的防御机制，只要应对反射型攻击；http 响应头中自动添加 x-xss-protection，默认打开
2. 对特定字符进行转义，内容注入替换尖括号等
3. CSP：内容安全策略：指定内容可以行

## CSRF 跨站请求伪造

原理：在第三方网站向本网站发起请求

1. 用户在 a 站前端页面发起登录（身份认证）请求
2. a 站后端确认身份，登陆成功，cookie 中存在用户的身份认真信息
3. b 站前端页面向 a 站后端发起请求，带着 a 站的 cookie 信息（身份认证）请求成功

综上，只要用户访问了 a 站后访问 b 站，b 站就可以带着 a 站的登录信息向 a 站发起请求

### 如何防御

特点，第三方网站使用认证信息进行访问

1. 禁止第三方网站携带本网站的 cookie 信息，设置 same-site 属性，same-site 属性有俩个值，strict（所有第三方请求都不能携带本网站 cookie），和 lax（链接可以，但是 form 表单提交和 ajax 不行）
2. 本网站前端页面添加验证信息：使用验证码或者 token 验证
3. referer 验证： 禁止来自第三方的请求

## 点击劫持

原理：第三方网站通过 iframe 内嵌一个网站，并且将 iframe 设为透明，将其覆盖在其他经过伪装的的 dom 上，伪装的可点击的 dom 与实际内嵌网站的可点击位置相同，

特点：用户自己做了点击，并且毫不知情

### 如何防御

1. 禁止 JavaScript 内嵌：当网页没有使用 iframe 内嵌时，top 和 window 是相等的，当网页被内嵌时，top 和 window 是不相等的
2. 设置 http 请求头
3. 一些辅助手段，比如添加验证码，提高用户安全意识
